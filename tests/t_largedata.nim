import unittest, helpers, sets, sequtils
import delaunay

suite "Large Data Sets":

    test "10 points":
        # These points were taken from here:
        # http://www.geom.uiuc.edu/locate/user/samuelp/rnd_10.ps

        let expected = edges(
            p(240.84, 0.0) -> p(293.758, 222.503),
            p(270.047, 326.4888) -> p(293.758, 222.503),
            p(222.766, 330.1085) -> p(293.758, 222.503),
            p(164.199, 206.129) -> p(293.758, 222.503),
            p(0.0, 209.774) -> p(240.84, 0.0),
            p(164.199, 206.129) -> p(240.84, 0.0),
            p(217.152, 355.0742) -> p(270.047, 326.4888),
            p(217.152, 355.0742) -> p(222.766, 330.1085),
            p(124.179, 257.139) -> p(217.152, 355.0742),
            p(52.9105, 288.189) -> p(217.152, 355.0742),
            p(222.766, 330.1085) -> p(270.047, 326.4888),
            p(124.179, 257.139) -> p(222.766, 330.1085),
            p(164.199, 206.129) -> p(222.766, 330.1085),
            p(124.179, 257.139) -> p(164.199, 206.129),
            p(9.1228, 224.344) -> p(124.179, 257.139),
            p(52.9105, 288.189) -> p(124.179, 257.139),
            p(9.1228, 224.344) -> p(164.199, 206.129),
            p(0.0, 209.774) -> p(9.1228, 224.344),
            p(9.1228, 224.344) -> p(52.9105, 288.189),
            p(0.0, 209.774) -> p(164.199, 206.129) )
        let triangulated = triangulate(expected)
        require( expected == triangulated )

    test "15 points":
        # These points were taken from here:
        # http://www.mathworks.com/help/matlab/math/voronoi-diagrams.html

        let expected = edges(
            p(-4.0, -1.0) -> p(-2.3, -0.7), p(-4.0, -1.0) -> p(-3.5, -2.9),
            p(-4.0, -1.0) -> p(-3.7, 1.5), p(0.0, -0.5) -> p(2.0, -1.5),
            p(-0.9, -3.9) -> p(0.0, -0.5), p(0.0, -0.5) -> p(0.8, 1.2),
            p(-1.5, 1.3) -> p(0.0, -0.5), p(-2.3, -0.7) -> p(0.0, -0.5),
            p(2.0, -3.5) -> p(2.0, -1.5), p(2.0, -3.5) -> p(3.5, -2.25),
            p(-0.9, -3.9) -> p(2.0, -3.5), p(-0.9, -3.9) -> p(2.0, -1.5),
            p(2.0, -1.5) -> p(3.5, -2.25), p(2.0, -1.5) -> p(3.7, -0.8),
            p(0.8, 1.2) -> p(2.0, -1.5), p(2.0, -1.5) -> p(3.3, 1.5),
            p(3.5, -2.25) -> p(3.7, -0.8), p(3.3, 1.5) -> p(3.7, -0.8),
            p(1.8, 3.3) -> p(3.3, 1.5), p(0.8, 1.2) -> p(3.3, 1.5),
            p(-1.5, 1.3) -> p(0.8, 1.2), p(0.8, 1.2) -> p(1.8, 3.3),
            p(-1.5, 3.2) -> p(0.8, 1.2), p(-3.5, -2.9) -> p(-0.9, -3.9),
            p(-3.5, -2.9) -> p(-2.3, -0.7), p(-2.3, -0.7) -> p(-0.9, -3.9),
            p(-2.3, -0.7) -> p(-1.5, 1.3), p(-3.7, 1.5) -> p(-2.3, -0.7),
            p(-3.7, 1.5) -> p(-1.5, 1.3), p(-1.5, 1.3) -> p(-1.5, 3.2),
            p(-1.5, 3.2) -> p(1.8, 3.3), p(-3.7, 1.5) -> p(-1.5, 3.2) )
        let triangulated = triangulate(expected)
        require( expected == triangulated )


    test "100 points":
        # These points were taken from here:
        # http://www.geom.uiuc.edu/locate/user/samuelp/rnd_100.ps

        let expected = edges(
            p(10.4936, 274.9466) -> p(19.4267, 280.9228),
            p(19.4267, 280.9228) -> p(40.328, 277.9291),
            p(19.4267, 280.9228) -> p(79.1631, 292.8664),
            p(19.4267, 280.9228) -> p(26.9061, 240.594),
            p(1.5104, 273.4452) -> p(19.4267, 280.9228),
            p(255.4231, 228.623) -> p(259.8991, 243.558),
            p(243.4611, 243.575) -> p(259.8991, 243.558),
            p(259.8991, 243.558) -> p(280.7981, 248.006),
            p(253.9251, 267.48) -> p(259.8991, 243.558),
            p(134.4261, 231.63) -> p(191.1831, 245.055),
            p(134.4261, 231.63) -> p(134.5251, 210.681),
            p(122.4761, 238.93) -> p(134.4261, 231.63),
            p(134.4261, 231.63) -> p(135.9231, 239.102),
            p(0.0, 161.435) -> p(22.4041, 207.729),
            p(16.4795, 171.882) -> p(22.4041, 207.729),
            p(22.4041, 207.729) -> p(22.4241, 224.166),
            p(0.00189, 228.647) -> p(22.4041, 207.729),
            p(22.4041, 207.729) -> p(34.3621, 204.749),
            p(22.4041, 207.729) -> p(37.3561, 200.25),
            p(271.8371, 180.841) -> p(273.3331, 182.313),
            p(259.8911, 136.044) -> p(271.8371, 180.841),
            p(256.9551, 195.767) -> p(271.8371, 180.841),
            p(271.8371, 180.841) -> p(286.7741, 134.55),
            p(237.5361, 162.922) -> p(271.8371, 180.841),
            p(41.8301, 40.452) -> p(52.2941, 74.802),
            p(28.379, 71.809) -> p(52.2941, 74.802),
            p(52.2941, 74.802) -> p(61.239, 98.517),
            p(52.2941, 74.802) -> p(91.1271, 88.103),
            p(52.2941, 74.802) -> p(76.184, 37.466),
            p(215.2231, 270.445) -> p(235.9941, 259.993),
            p(210.6281, 290.8921) -> p(215.2231, 270.445),
            p(215.2231, 270.445) -> p(219.5621, 271.92),
            p(191.1831, 245.055) -> p(215.2231, 270.445),
            p(186.7011, 262.999) -> p(215.2231, 270.445),
            p(204.6271, 292.4606) -> p(215.2231, 270.445),
            p(210.6281, 290.8921) -> p(291.2541, 268.966),
            p(210.6281, 290.8921) -> p(253.9251, 267.48),
            p(210.6281, 290.8921) -> p(219.5621, 271.92),
            p(204.6271, 292.4606) -> p(210.6281, 290.8921),
            p(40.328, 277.9291) -> p(79.1631, 292.8664),
            p(79.1631, 292.8664) -> p(82.1751, 246.561),
            p(79.1631, 292.8664) -> p(101.5841, 274.9452),
            p(79.1631, 292.8664) -> p(204.6271, 292.4606),
            p(255.4231, 228.623) -> p(280.7981, 248.006),
            p(273.3331, 182.313) -> p(280.7981, 248.006),
            p(280.7981, 248.006) -> p(291.2541, 268.966),
            p(253.9251, 267.48) -> p(280.7981, 248.006),
            p(22.4241, 224.166) -> p(28.385, 237.591),
            p(28.385, 237.591) -> p(34.3621, 204.749),
            p(26.9061, 240.594) -> p(28.385, 237.591),
            p(8.9758, 240.317) -> p(28.385, 237.591),
            p(28.385, 237.591) -> p(76.1891, 236.112),
            p(97.0881, 254.034) -> p(101.5841, 274.9452),
            p(101.5841, 274.9452) -> p(113.5151, 260.002),
            p(82.1751, 246.561) -> p(101.5841, 274.9452),
            p(101.5841, 274.9452) -> p(186.7011, 262.999),
            p(101.5841, 274.9452) -> p(204.6271, 292.4606),
            p(41.855, 5.8604) -> p(86.6391, 0.0),
            p(86.6391, 0.0) -> p(164.3001, 47.901),
            p(68.709, 10.581) -> p(86.6391, 0.0),
            p(76.1761, 9.081) -> p(86.6391, 0.0),
            p(86.6391, 0.0) -> p(206.1281, 12.0639),
            p(86.6391, 0.0) -> p(230.0171, 0.077453),
            p(86.6391, 0.0) -> p(91.1091, 19.541),
            p(113.5151, 260.002) -> p(186.7011, 262.999),
            p(186.7011, 262.999) -> p(191.1831, 245.055),
            p(186.7011, 262.999) -> p(204.6271, 292.4606),
            p(135.9231, 239.102) -> p(186.7011, 262.999),
            p(235.9941, 259.993) -> p(243.4611, 243.575),
            p(224.0441, 215.202) -> p(243.4611, 243.575),
            p(243.4611, 243.575) -> p(253.9251, 267.48),
            p(191.1831, 245.055) -> p(243.4611, 243.575),
            p(243.4611, 243.575) -> p(255.4231, 228.623),
            p(88.1281, 180.848) -> p(134.5251, 210.681),
            p(88.1281, 180.848) -> p(143.3901, 194.294),
            p(74.6871, 198.77) -> p(88.1281, 180.848),
            p(88.1281, 180.848) -> p(94.1221, 161.428),
            p(82.2601, 174.877) -> p(88.1281, 180.848),
            p(0.0, 161.435) -> p(16.4795, 171.882),
            p(0.0, 161.435) -> p(0.00189, 228.647),
            p(0.0, 161.435) -> p(5.9912, 146.495),
            p(0.0, 161.435) -> p(10.4615, 162.91),
            p(0.0, 161.435) -> p(7.4694, 16.541),
            p(0.0, 161.435) -> p(11.9564, 53.875),
            p(28.379, 164.312) -> p(32.879, 171.888),
            p(22.4091, 168.899) -> p(28.379, 164.312),
            p(28.379, 164.312) -> p(46.3081, 153.954),
            p(10.4615, 162.91) -> p(28.379, 164.312),
            p(19.4183, 137.123) -> p(28.379, 164.312),
            p(242.4821, 10.536) -> p(286.7741, 134.55),
            p(264.3721, 122.596) -> p(286.7741, 134.55),
            p(286.7741, 134.55) -> p(291.2541, 268.966),
            p(262.8751, 94.204) -> p(286.7741, 134.55),
            p(273.3331, 182.313) -> p(286.7741, 134.55),
            p(259.8911, 136.044) -> p(286.7741, 134.55),
            p(70.2231, 31.486) -> p(91.1091, 19.541),
            p(91.1091, 19.541) -> p(164.3001, 47.901),
            p(76.1761, 9.081) -> p(91.1091, 19.541),
            p(76.184, 37.466) -> p(91.1091, 19.541),
            p(91.1091, 19.541) -> p(91.1271, 88.103),
            p(38.8451, 122.578) -> p(40.3291, 134.55),
            p(40.3291, 134.55) -> p(46.3081, 153.954),
            p(40.3291, 134.55) -> p(46.3031, 129.851),
            p(19.4183, 137.123) -> p(40.3291, 134.55),
            p(46.3031, 129.851) -> p(61.239, 98.517),
            p(46.3031, 129.851) -> p(61.333, 155.455),
            p(38.8451, 122.578) -> p(46.3031, 129.851),
            p(46.3031, 129.851) -> p(80.6701, 142.001),
            p(46.3031, 129.851) -> p(46.3081, 153.954),
            p(41.8301, 40.452) -> p(41.855, 5.8604),
            p(41.855, 5.8604) -> p(70.2231, 31.486),
            p(19.4691, 35.954) -> p(41.855, 5.8604),
            p(41.855, 5.8604) -> p(68.709, 10.581),
            p(7.4694, 16.541) -> p(41.855, 5.8604),
            p(0.00189, 228.647) -> p(22.4241, 224.166),
            p(0.00189, 228.647) -> p(8.9758, 240.317),
            p(0.00189, 228.647) -> p(1.5104, 273.4452),
            p(16.4795, 171.882) -> p(37.3561, 200.25),
            p(37.3561, 200.25) -> p(40.3471, 183.821),
            p(34.3621, 204.749) -> p(37.3561, 200.25),
            p(37.3561, 200.25) -> p(74.6871, 198.77),
            p(203.1471, 83.759) -> p(210.6901, 149.486),
            p(186.7091, 156.932) -> p(210.6901, 149.486),
            p(207.6181, 192.8) -> p(210.6901, 149.486),
            p(189.6871, 162.872) -> p(210.6901, 149.486),
            p(210.6901, 149.486) -> p(244.9611, 112.133),
            p(210.6901, 149.486) -> p(259.8911, 136.044),
            p(210.6901, 149.486) -> p(237.5361, 162.922),
            p(242.4821, 10.536) -> p(262.8751, 94.204),
            p(235.9901, 34.408) -> p(242.4821, 10.536),
            p(234.5041, 7.4159) -> p(242.4821, 10.536),
            p(230.0171, 0.077453) -> p(242.4821, 10.536),
            p(273.3331, 182.313) -> p(291.2541, 268.966),
            p(253.9251, 267.48) -> p(291.2541, 268.966),
            p(159.8371, 164.402) -> p(186.7091, 156.932),
            p(186.7091, 156.932) -> p(203.1471, 83.759),
            p(167.2841, 168.903) -> p(186.7091, 156.932),
            p(186.7091, 156.932) -> p(189.6871, 162.872),
            p(206.1281, 12.0639) -> p(235.9901, 34.408),
            p(225.5341, 43.438) -> p(235.9901, 34.408),
            p(234.5041, 7.4159) -> p(235.9901, 34.408),
            p(235.9901, 34.408) -> p(262.8751, 94.204),
            p(255.4231, 228.623) -> p(256.9551, 195.767),
            p(224.0441, 215.202) -> p(255.4231, 228.623),
            p(255.4231, 228.623) -> p(273.3331, 182.313),
            p(22.4241, 224.166) -> p(34.3621, 204.749),
            p(34.3621, 204.749) -> p(74.6871, 198.77),
            p(34.3621, 204.749) -> p(76.1891, 236.112),
            p(8.9758, 240.317) -> p(10.4936, 274.9466),
            p(8.9758, 240.317) -> p(22.4241, 224.166),
            p(8.9758, 240.317) -> p(26.9061, 240.594),
            p(1.5104, 273.4452) -> p(8.9758, 240.317),
            p(7.4694, 16.541) -> p(19.4691, 35.954),
            p(7.4694, 16.541) -> p(11.9564, 53.875),
            p(61.239, 98.517) -> p(91.1271, 88.103),
            p(91.1271, 88.103) -> p(106.0851, 109.12),
            p(91.1271, 88.103) -> p(164.3001, 47.901),
            p(76.184, 37.466) -> p(91.1271, 88.103),
            p(10.4936, 274.9466) -> p(26.9061, 240.594),
            p(1.5104, 273.4452) -> p(10.4936, 274.9466),
            p(206.1281, 12.0639) -> p(230.0171, 0.077453),
            p(230.0171, 0.077453) -> p(234.5041, 7.4159),
            p(203.1471, 83.759) -> p(262.8751, 94.204),
            p(262.8751, 94.204) -> p(264.3721, 122.596),
            p(225.5341, 43.438) -> p(262.8751, 94.204),
            p(244.9611, 112.133) -> p(262.8751, 94.204),
            p(206.1281, 12.0639) -> p(225.5341, 43.438),
            p(203.1471, 83.759) -> p(225.5341, 43.438),
            p(176.2521, 47.916) -> p(225.5341, 43.438),
            p(10.4615, 162.91) -> p(19.4183, 137.123),
            p(10.4615, 162.91) -> p(16.4795, 171.882),
            p(10.4615, 162.91) -> p(22.4091, 168.899),
            p(5.9912, 146.495) -> p(10.4615, 162.91),
            p(11.9564, 53.875) -> p(41.8301, 40.452),
            p(11.9564, 53.875) -> p(19.4691, 35.954),
            p(11.9564, 53.875) -> p(28.379, 71.809),
            p(5.9912, 146.495) -> p(11.9564, 53.875),
            p(259.8911, 136.044) -> p(264.3721, 122.596),
            p(244.9611, 112.133) -> p(259.8911, 136.044),
            p(237.5361, 162.922) -> p(259.8911, 136.044),
            p(40.328, 277.9291) -> p(76.1891, 236.112),
            p(76.1891, 236.112) -> p(103.1051, 246.563),
            p(26.9061, 240.594) -> p(76.1891, 236.112),
            p(76.1891, 236.112) -> p(82.1751, 246.561),
            p(74.6871, 198.77) -> p(76.1891, 236.112),
            p(16.4795, 171.882) -> p(32.879, 171.888),
            p(16.4795, 171.882) -> p(22.4091, 168.899),
            p(16.4795, 171.882) -> p(40.3471, 183.821),
            p(32.879, 171.888) -> p(46.3081, 153.954),
            p(22.4091, 168.899) -> p(32.879, 171.888),
            p(32.879, 171.888) -> p(40.3471, 183.821),
            p(256.9551, 195.767) -> p(273.3331, 182.313),
            p(113.5151, 260.002) -> p(122.4761, 238.93),
            p(103.1051, 246.563) -> p(122.4761, 238.93),
            p(122.4761, 238.93) -> p(134.5251, 210.681),
            p(74.6871, 198.77) -> p(122.4761, 238.93),
            p(122.4761, 238.93) -> p(135.9231, 239.102),
            p(113.5151, 260.002) -> p(135.9231, 239.102),
            p(135.9231, 239.102) -> p(191.1831, 245.055),
            p(191.1831, 245.055) -> p(235.9941, 259.993),
            p(219.5621, 271.92) -> p(235.9941, 259.993),
            p(235.9941, 259.993) -> p(253.9251, 267.48),
            p(207.6181, 192.8) -> p(237.5361, 162.922),
            p(237.5361, 162.922) -> p(256.9551, 195.767),
            p(221.0641, 195.777) -> p(237.5361, 162.922),
            p(224.0441, 215.202) -> p(256.9551, 195.767),
            p(221.0641, 195.777) -> p(256.9551, 195.767),
            p(97.0881, 254.034) -> p(113.5151, 260.002),
            p(103.1051, 246.563) -> p(113.5151, 260.002),
            p(97.0881, 254.034) -> p(103.1051, 246.563),
            p(82.1751, 246.561) -> p(103.1051, 246.563),
            p(74.6871, 198.77) -> p(103.1051, 246.563),
            p(82.1751, 246.561) -> p(97.0881, 254.034),
            p(68.709, 10.581) -> p(70.2231, 31.486),
            p(68.709, 10.581) -> p(76.1761, 9.081),
            p(203.1471, 83.759) -> p(244.9611, 112.133),
            p(244.9611, 112.133) -> p(264.3721, 122.596),
            p(82.2601, 174.877) -> p(83.6771, 158.446),
            p(80.6701, 142.001) -> p(83.6771, 158.446),
            p(61.333, 155.455) -> p(83.6771, 158.446),
            p(83.6771, 158.446) -> p(94.1221, 161.428),
            p(206.1281, 12.0639) -> p(234.5041, 7.4159),
            p(19.4691, 35.954) -> p(41.8301, 40.452),
            p(94.1221, 161.428) -> p(159.8371, 164.402),
            p(94.1221, 161.428) -> p(106.0851, 109.12),
            p(80.6701, 142.001) -> p(94.1221, 161.428),
            p(94.1221, 161.428) -> p(143.3901, 194.294),
            p(82.2601, 174.877) -> p(94.1221, 161.428),
            p(164.3001, 47.901) -> p(203.1471, 83.759),
            p(106.0851, 109.12) -> p(164.3001, 47.901),
            p(164.3001, 47.901) -> p(176.2521, 47.916),
            p(164.3001, 47.901) -> p(206.1281, 12.0639),
            p(28.379, 71.809) -> p(41.8301, 40.452),
            p(28.379, 71.809) -> p(61.239, 98.517),
            p(28.379, 71.809) -> p(38.8451, 122.578),
            p(19.4183, 137.123) -> p(28.379, 71.809),
            p(5.9912, 146.495) -> p(28.379, 71.809),
            p(41.8301, 40.452) -> p(70.2231, 31.486),
            p(41.8301, 40.452) -> p(76.184, 37.466),
            p(46.3081, 153.954) -> p(61.333, 155.455),
            p(40.3471, 183.821) -> p(61.333, 155.455),
            p(61.333, 155.455) -> p(80.6701, 142.001),
            p(61.333, 155.455) -> p(82.2601, 174.877),
            p(38.8451, 122.578) -> p(61.239, 98.517),
            p(19.4183, 137.123) -> p(38.8451, 122.578),
            p(70.2231, 31.486) -> p(76.1761, 9.081),
            p(159.8371, 164.402) -> p(167.2841, 168.903),
            p(167.2841, 168.903) -> p(201.6851, 203.229),
            p(143.3901, 194.294) -> p(167.2841, 168.903),
            p(167.2841, 168.903) -> p(189.6871, 162.872),
            p(26.9061, 240.594) -> p(40.328, 277.9291),
            p(19.4183, 137.123) -> p(46.3081, 153.954),
            p(40.3471, 183.821) -> p(46.3081, 153.954),
            p(5.9912, 146.495) -> p(19.4183, 137.123),
            p(61.239, 98.517) -> p(80.6701, 142.001),
            p(80.6701, 142.001) -> p(106.0851, 109.12),
            p(134.5251, 210.681) -> p(191.1831, 245.055),
            p(134.5251, 210.681) -> p(143.3901, 194.294),
            p(74.6871, 198.77) -> p(134.5251, 210.681),
            p(159.8371, 164.402) -> p(203.1471, 83.759),
            p(106.0851, 109.12) -> p(159.8371, 164.402),
            p(143.3901, 194.294) -> p(159.8371, 164.402),
            p(201.6851, 203.229) -> p(207.6181, 192.8),
            p(189.6871, 162.872) -> p(201.6851, 203.229),
            p(191.1831, 245.055) -> p(201.6851, 203.229),
            p(201.6851, 203.229) -> p(224.0441, 215.202),
            p(201.6851, 203.229) -> p(221.0641, 195.777),
            p(143.3901, 194.294) -> p(201.6851, 203.229),
            p(61.239, 98.517) -> p(106.0851, 109.12),
            p(106.0851, 109.12) -> p(203.1471, 83.759),
            p(219.5621, 271.92) -> p(253.9251, 267.48),
            p(189.6871, 162.872) -> p(207.6181, 192.8),
            p(191.1831, 245.055) -> p(224.0441, 215.202),
            p(143.3901, 194.294) -> p(191.1831, 245.055),
            p(176.2521, 47.916) -> p(206.1281, 12.0639),
            p(221.0641, 195.777) -> p(224.0441, 215.202),
            p(40.3471, 183.821) -> p(74.6871, 198.77),
            p(74.6871, 198.77) -> p(82.2601, 174.877),
            p(40.3471, 183.821) -> p(82.2601, 174.877),
            p(70.2231, 31.486) -> p(76.184, 37.466),
            p(40.328, 277.9291) -> p(82.1751, 246.561),
            p(176.2521, 47.916) -> p(203.1471, 83.759),
            p(207.6181, 192.8) -> p(221.0641, 195.777) )
        let triangulated = triangulate(expected)
        require( expected == triangulated )


